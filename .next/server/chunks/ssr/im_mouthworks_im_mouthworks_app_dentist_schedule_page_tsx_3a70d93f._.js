module.exports=[44798,a=>{"use strict";var b=a.i(80332),c=a.i(54358),d=a.i(85516),e=a.i(70478),f=a.i(69933),g=a.i(34520),h=a.i(19589),i=a.i(55239),j=a.i(55616),k=a.i(85920),l=a.i(26957),m=a.i(16349),n=a.i(63),o=a.i(83460),p=a.i(98185);let q=(0,a.i(42308).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var r=a.i(60335),s=a.i(22851),t=a.i(35924),u=a.i(65593);function v({appointment:a,onClose:d,onApprove:e,onReject:f}){let[g,i]=(0,c.useState)(""),[j,k]=(0,c.useState)(!1);return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-card rounded-lg shadow-2xl max-w-md w-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Appointment Details"}),(0,b.jsx)("button",{onClick:d,className:"p-1 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(u.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Patient"}),(0,b.jsx)("p",{className:"text-foreground font-semibold",children:a.patientName||a.patients?.name||"N/A"}),a.patients?.email&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.patients.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Service"}),(0,b.jsx)("p",{className:"text-foreground",children:a.service})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),(0,b.jsx)("p",{className:"text-foreground",children:a.date})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Time"}),(0,b.jsx)("p",{className:"text-foreground",children:a.time})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),(0,b.jsx)("p",{className:"text-foreground capitalize font-medium",children:a.status})]}),a.notes&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),(0,b.jsx)("p",{className:"text-foreground text-sm",children:a.notes})]})]}),j&&(0,b.jsxs)("div",{className:"space-y-2 pt-4 border-t border-border",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Rejection Reason"}),(0,b.jsx)("textarea",{value:g,onChange:a=>i(a.target.value),placeholder:"Why are you rejecting this appointment?",className:"w-full p-2 border border-border rounded-lg text-sm resize-none",rows:3})]}),(0,b.jsx)("div",{className:"flex gap-2 pt-4",children:j?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Button,{onClick:()=>k(!1),variant:"outline",className:"flex-1",children:"Back"}),(0,b.jsx)(h.Button,{onClick:()=>{g.trim()&&f(g)},disabled:!g.trim(),className:"flex-1 bg-destructive hover:bg-destructive/90 text-destructive-foreground",children:"Confirm Reject"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Button,{onClick:d,variant:"outline",className:"flex-1 bg-transparent",children:"Close"}),(0,b.jsxs)(h.Button,{onClick:()=>k(!0),variant:"outline",className:"flex-1 text-destructive hover:bg-destructive/10",children:[(0,b.jsx)(n.XCircle,{className:"w-4 h-4 mr-2"}),"Reject"]}),(0,b.jsxs)(h.Button,{onClick:e,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:[(0,b.jsx)(m.CheckCircle,{className:"w-4 h-4 mr-2"}),"Approve"]})]})})]})]})})}function w(){let a,{user:u}=(0,e.useAuth)(),w=(0,d.useRouter)(),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(new Date),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!0);(0,c.useEffect)(()=>{H()},[u?.id]);let H=async()=>{try{if(G(!0),u?.id){let a=await t.appointmentService.getByDentistId(u.id);y(a||[])}}catch(a){console.error("[v0] Error loading dentist appointments:",a instanceof Error?a.message:String(a)),y([])}finally{G(!1)}},I=[{label:"Dashboard",icon:(0,b.jsx)(i.LayoutDashboard,{className:"w-5 h-5"}),href:"/dentist/dashboard"},{label:"My Schedule",icon:(0,b.jsx)(j.Calendar,{className:"w-5 h-5"}),href:"/dentist/schedule"},{label:"Treatments",icon:(0,b.jsx)(k.Bluetooth,{className:"w-5 h-5"}),href:"/dentist/treatments"},{label:"Earnings",icon:(0,b.jsx)(s.DollarSign,{className:"w-5 h-5"}),href:"/dentist/earnings"},{label:"Reports",icon:(0,b.jsx)(l.BarChart3,{className:"w-5 h-5"}),href:"/dentist/reports"}],J=async a=>{try{await t.appointmentService.changeStatus(a,"confirmed"),y(x.map(b=>b.id===a?{...b,status:"confirmed"}:b));try{await t.appointmentService.changeStatus(a,"completed"),y(b=>b.map(b=>b.id===a?{...b,status:"completed"}:b));let b=x.find(b=>b.id===a);if(b){let a=0;if(b.treatment_id)try{let c=await t.treatmentService.getById(b.treatment_id);a=c?.price||0}catch(a){console.warn("Could not resolve treatment by id for payment:",a)}if(!a)try{let c=(await t.treatmentService.getAll()||[]).find(a=>a.name===(b.service||b.treatment));a=c?.price||b.amount||0}catch(a){console.warn("Could not lookup treatments for amount resolution:",a)}let c={patient_id:b.patient_id,appointment_id:b.id,dentist_id:b.dentist_id||u?.id,amount:a||0,method:"cash",status:"paid",description:`Payment for ${b.service||"treatment"}`,date:new Date().toISOString().split("T")[0]};try{await t.paymentService.create(c)}catch(a){console.error("Error creating payment record after approve:",a)}}}catch(a){console.error("Error completing + charging appointment after approve:",a)}C(!1);try{w.push("/dentist/schedule")}catch(a){console.warn("Navigation to schedule failed:",a)}}catch(a){console.error("Error approving appointment:",a)}},K=async(a,b)=>{try{await t.appointmentService.update(a,{status:"rejected",notes:b}),y(x.map(c=>c.id===a?{...c,status:"rejected",notes:b}:c)),C(!1);try{w.push("/dentist/schedule")}catch(a){console.warn("Navigation to schedule failed:",a)}}catch(a){console.error("Error rejecting appointment:",a)}},L=async a=>{try{await t.appointmentService.changeStatus(a,"completed"),y(x.map(b=>b.id===a?{...b,status:"completed"}:b));try{let b=x.find(b=>b.id===a);if(b){let a=0;if(b.treatment_id)try{let c=await t.treatmentService.getById(b.treatment_id);a=c?.price||0}catch(a){console.warn("Could not resolve treatment by id for payment:",a)}if(!a)try{let c=(await t.treatmentService.getAll()||[]).find(a=>a.name===(b.service||b.treatment));a=c?.price||b.amount||0}catch(a){console.warn("Could not lookup treatments for amount resolution:",a)}let c={patient_id:b.patient_id,appointment_id:b.id,dentist_id:b.dentist_id||u?.id,amount:a||0,method:"cash",status:"paid",description:`Payment for ${b.service||"treatment"}`,date:new Date().toISOString().split("T")[0]};try{await t.paymentService.create(c)}catch(a){console.error("Error creating payment record:",a)}}}catch(a){console.error("Error while creating payment after completion:",a)}}catch(a){console.error("Error completing appointment:",a)}},M=a=>{E(a),C(!0)},N=(a=z.toISOString().split("T")[0],x.filter(b=>b.date===a)),O=x.filter(a=>"pending"===a.status),P=x.filter(a=>"confirmed"===a.status);return(0,b.jsxs)(f.default,{navItems:I,title:"My Schedule",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Your Dental Schedule"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Review pending appointments and manage your schedule"})]}),O.length>0&&(0,b.jsxs)(g.Card,{className:"border-yellow-300 bg-yellow-50/50",children:[(0,b.jsxs)(g.CardHeader,{className:"pb-3",children:[(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2 text-yellow-900",children:[(0,b.jsx)(o.Clock,{className:"w-5 h-5 text-yellow-600"}),"Action Required: ",O.length," Pending Approval",1!==O.length?"s":""]}),(0,b.jsx)(g.CardDescription,{className:"text-yellow-800",children:"HR has scheduled these appointments for you. Please review and approve or reject them."})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:O.map(a=>(0,b.jsxs)("div",{className:"p-4 border-2 border-yellow-300 bg-white rounded-lg hover:bg-yellow-50/30 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-lg text-foreground",children:a.patients?.name||a.patientName}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.service||"General Visit"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-bold text-primary",children:a.date}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.time})]})]}),a.notes&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-3 p-2 bg-muted/50 rounded",children:[(0,b.jsx)("span",{className:"font-medium",children:"Notes:"})," ",a.notes]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(h.Button,{onClick:()=>J(a.id),className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium",children:[(0,b.jsx)(m.CheckCircle,{className:"w-4 h-4 mr-2"}),"Approve"]}),(0,b.jsxs)(h.Button,{onClick:()=>M(a),variant:"outline",className:"flex-1 text-destructive hover:bg-destructive/10 font-medium",children:[(0,b.jsx)(n.XCircle,{className:"w-4 h-4 mr-2"}),"Reject"]})]})]},a.id))})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{children:"Daily Schedule"}),(0,b.jsx)(g.CardDescription,{children:z.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>{A(new Date(z.getTime()-864e5))},className:"p-2 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(q,{className:"w-5 h-5"})}),(0,b.jsx)("button",{onClick:()=>A(new Date),className:"px-4 py-2 hover:bg-muted rounded-lg transition-colors text-sm font-medium",children:"Today"}),(0,b.jsx)("button",{onClick:()=>{A(new Date(z.getTime()+864e5))},className:"p-2 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(r.ChevronRight,{className:"w-5 h-5"})})]})]}),(0,b.jsx)(g.CardContent,{children:0===N.length?(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No appointments scheduled for this date"})}):(0,b.jsx)("div",{className:"space-y-3",children:N.map(a=>(0,b.jsxs)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-foreground",children:a.patients?.name||a.patientName}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.service})]}),(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${"confirmed"===a.status?"bg-green-100 text-green-700":"pending"===a.status?"bg-yellow-100 text-yellow-700":"completed"===a.status?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,b.jsx)(o.Clock,{className:"w-4 h-4"}),a.time]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(h.Button,{size:"sm",variant:"outline",className:"text-xs bg-transparent",onClick:()=>M(a),children:[(0,b.jsx)(p.Eye,{className:"w-3 h-3 mr-1"}),"Details"]}),"pending"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(h.Button,{size:"sm",onClick:()=>J(a.id),className:"bg-green-600 hover:bg-green-700 text-white text-xs",children:[(0,b.jsx)(m.CheckCircle,{className:"w-3 h-3 mr-1"}),"Approve"]}),(0,b.jsxs)(h.Button,{size:"sm",onClick:()=>M(a),variant:"outline",className:"text-xs text-destructive hover:bg-destructive/10",children:[(0,b.jsx)(n.XCircle,{className:"w-3 h-3 mr-1"}),"Reject"]})]}),"confirmed"===a.status&&(0,b.jsxs)(h.Button,{size:"sm",onClick:()=>L(a.id),className:"bg-blue-600 hover:bg-blue-700 text-white text-xs",children:[(0,b.jsx)(m.CheckCircle,{className:"w-3 h-3 mr-1"}),"Complete"]})]})]})]},a.id))})})]}),O.length>0&&(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(o.Clock,{className:"w-5 h-5 text-yellow-600"}),"Pending Approvals (",O.length,")"]}),(0,b.jsx)(g.CardDescription,{children:"Appointments awaiting your decision"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:O.map(a=>(0,b.jsxs)("div",{className:"p-4 border border-yellow-200 bg-yellow-50/50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-foreground",children:a.patientName}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.service})]}),(0,b.jsxs)("div",{className:"text-sm font-medium text-muted-foreground",children:[a.date," at ",a.time]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(h.Button,{onClick:()=>J(a.id),className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:[(0,b.jsx)(m.CheckCircle,{className:"w-4 h-4 mr-2"}),"Approve"]}),(0,b.jsxs)(h.Button,{onClick:()=>M(a),variant:"outline",className:"flex-1 text-destructive hover:bg-destructive/10",children:[(0,b.jsx)(n.XCircle,{className:"w-4 h-4 mr-2"}),"Reject"]})]})]},a.id))})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)(g.Card,{className:"hover:shadow-md transition-shadow",children:[(0,b.jsx)(g.CardHeader,{className:"pb-3",children:(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Pending Approvals"})}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold text-yellow-600",children:O.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Awaiting your action"})]})]}),(0,b.jsxs)(g.Card,{className:"hover:shadow-md transition-shadow",children:[(0,b.jsx)(g.CardHeader,{className:"pb-3",children:(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Confirmed Today"})}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold text-green-600",children:N.filter(a=>"confirmed"===a.status).length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Scheduled for today"})]})]}),(0,b.jsxs)(g.Card,{className:"hover:shadow-md transition-shadow",children:[(0,b.jsx)(g.CardHeader,{className:"pb-3",children:(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"This Week"})}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold text-primary",children:x.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Total appointments"})]})]})]}),P.length>0&&(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.CheckCircle,{className:"w-5 h-5 text-green-600"}),"Confirmed Appointments (",P.length,")"]})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:P.slice(0,5).map(a=>(0,b.jsxs)("div",{className:"p-3 border border-border rounded-lg hover:bg-muted/50 transition-colors flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-foreground",children:a.patientName}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.date," at ",a.time," - ",a.service]})]}),(0,b.jsx)(h.Button,{size:"sm",onClick:()=>L(a.id),className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Complete"})]},a.id))})})]})]}),B&&D&&(0,b.jsx)(v,{appointment:D,onClose:()=>C(!1),onApprove:()=>{J(D.id),C(!1)},onReject:a=>{K(D.id,a),C(!1)}})]})}a.s(["default",()=>w],44798)}];

//# sourceMappingURL=im_mouthworks_im_mouthworks_app_dentist_schedule_page_tsx_3a70d93f._.js.map